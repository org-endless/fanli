## 1 产品

- 根据EVE基础数据新增和更新产品信息
- 删除基础数据中没有的产品
- 产品是EVE市场可以发布的物品或者生产和科研的产出物
- 产品信息包括产品id、产品名称（中文、英文）
- 产品需要判断T1、T2、行星、配方

## 1 市场

### 1.1 当前价格

- 根据市场订单信息，计算产品当前价格
- 当前价格从EVE市场订单接口获得，包括买入价格和卖出价格
- 当前买入价格 = max(买入订单价格)
- 当前卖出价格 = min(卖出订单价格)

### 1.2 日均销量

- 根据市场历史信息，计算产品日均销量
- 市场历史信息EVE市场历史接口中获得，获取过去一整年的数据
- 日均销量 = 过去365天总销量 / 365

### 1.3 通知

- 市场信息获取成功后，通知进行产品利润计算

## 配方

- 根据EVE元数据生成配方
- 可根据产品ID查询是否拥有配方和产品配方的原料和时间
- T1配方可进行拷贝、时间和原料科研
- 拷贝后的配方可进行T2科研，产出T2配方

## 2 成本

- 根据配方、市场现价计算生产材料成本、生产设施使用成本、科研材料成本、科研设施使用成本
- 科研成本只有T2产品有
- 生产成本 = 生产材料成本 + 生产设施使用成本
- 科研成本 = 科研材料成本 + 科研设施使用成本
- 成本 = 生产成本 + 科研成本
- 生产资料成本暂未计算，后续考虑

## 2 生产

- 根据产品利润和可用产线生成生产计划
- 生产计算周期为天，所以生成生产计划的利润以日利润为基准
- 产品已在生产不能生产
- 产品无蓝图不能生产
- 产品在售不应该生产
- 产品蓝图在科研不能生产
- 生产计划分T1、T2、行星三种类型，利润计算方式有所区别
- T1和行星生产使用蓝图即可
- T2科研的材料成本要计算到产品成本当中去，时间成本为单独产线，所以可以不用计算
- 如果原料中包含可生产的产品，则根据毛利润确定是否进行原料生产

## 利润

- 根据成本、市场现价、税费、计算产品利润
- 根据配方、市场现价、各类费用计算产品利润
- 利润包括毛利润、单产品利润、和产线日利润
- 毛利润 = 成本

## 销售

- 根据市场销售订单

# 生产计划
